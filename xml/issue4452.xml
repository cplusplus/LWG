<?xml version='1.0' encoding='utf-8' standalone='no'?>
<!DOCTYPE issue SYSTEM "lwg-issue.dtd">

<issue num="4452" status="WP">
<title>Make <i>deref-move</i> constexpr</title>
<section><sref ref="[specialized.algorithms.general]"/></section>
<submitter>S.B. Tam</submitter>
<date>05 Nov 2025</date>
<priority>99</priority>

<discussion>
<p>
`std::uninitialized_move` and `std::uninitialized_move_n` are constexpr and invoke <i>`deref-move`</i>,
but <i>`deref-move`</i> is not constexpr. This looks like an obvious mistake.
</p>

<p>
Jiang An pointed out that <paper num="P3508R0"/> and LWG <iref ref="3918"/>,
both touching `std::uninitialized_move(_n)`, were adopted at the same meeting,
and unfortunately none of them was aware of the other.
</p>

<note>Kona 2025-11-06; approved by LWG. Status changed: New &rarr; Immediate.</note>
<note>Kona 2025-11-08; Status changed: Immediate &rarr; WP.</note>
</discussion>

<resolution>
<p>
This wording is relative to <paper num="N5014"/>.
</p>

<ol>
<li><p>Modify <sref ref="[specialized.algorithms.general]"/>, as indicated:</p>

<blockquote>
<pre>
template&lt;class I&gt;
  <ins>constexpr</ins> decltype(auto) <i>deref-move</i>(I&amp; it) {
    if constexpr (is_lvalue_reference_v&lt;decltype(*it)&gt;)
      return std::move(*it);
    else
      return *it;
  }
</pre>
</blockquote>
</li>
</ol>

</resolution>

</issue>
