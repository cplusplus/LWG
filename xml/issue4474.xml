<?xml version='1.0' encoding='utf-8' standalone='no'?>
<!DOCTYPE issue SYSTEM "lwg-issue.dtd">

<issue num="4474" status="Tentatively Ready">
<title>"`round_to_nearest`" rounding mode is unclear</title>
<section><sref ref="[round.style]"/></section>
<submitter>Jan Schultke</submitter>
<date>13 Nov 2025</date>
<priority>99</priority>

<discussion>
<p>
Consider the specification of `round_to_nearest` in <sref ref="[round.style]"/>:
</p>
<blockquote><p>
`round_to_nearest` if the rounding style is to the nearest representable value
</p></blockquote>
<p>
It is unclear how exact ties are rounded. For example, with this rounding, would a value
that is equidistant to zero and <tt>numeric_limits&lt;float&gt;::min()</tt> be rounded 
towards zero or away from zero?
<p/>
In <sref ref="[numeric.limits.members]"/>, there exists a footnote for <tt>numeric_limits&lt;T&gt;::round_style</tt>:
</p>
<blockquote><p>
185) Equivalent to `FLT_ROUNDS`. Required by ISO/IEC 10967-1:2012.
</p></blockquote>
<p>
In C23 5.2.4.2.2 [Characteristics of floating types <tt>&lt;float.h&gt;</tt>], it is specified 
that a value of `1` for `FLT_ROUNDS` (which equals `round_to_nearest`) means
</p>
<blockquote><p>
to nearest, ties to even
</p></blockquote>
<p>
This is also the default ISO/IEC 60559 rounding mode, and chosen by standard libraries such as 
libstdc++ for `numeric_limits` under that assumption. Do note that C23 no longer references 
ISO/IEC 10967 in any normative wording, so presumably, matching `FLT_ROUNDS` values means to match 
the value that exists in C23, including its meaning.
</p>

<note>2026-01-16; Reflector poll.</note>
<p>
Set status to Tentatively Ready after seven votes in favour during reflector poll.
</p>
<p>
"IEEE 754-2019 talks about what to do in case of a tie for single digit precision types,
such as FP4 (E2M1). Will raise this with WG14." [E2M1 is 1 sign bit, 2 exponent bits, 1 explicit mantissa bit]
</p>
</discussion>

<resolution>
<p>
This wording is relative to <paper num="N5014"/>.
</p>

<ol>
<li><p>Modify <sref ref="[round.style]"/> as indicated:</p>

<blockquote>
<p>
-1- The rounding mode for floating-point arithmetic is characterized by the values:
</p>
<ul style="list-style-type: none">
<li>(1.1) &mdash; 
`round_indeterminate` if the rounding style is indeterminable
</li>
<li>(1.2) &mdash; 
`round_toward_zero` if the rounding style is toward zero
</li>
<li>(1.3) &mdash; 
`round_to_nearest` if the rounding style is to the nearest representable value<ins>; if there are 
two equally near such values, the one with an even least significant digit is chosen</ins>
</li>
<li>(1.4) &mdash; 
`round_toward_infinity` if the rounding style is toward infinity
</li>
<li>(1.5) &mdash; 
`round_toward_neg_infinity` if the rounding style is toward negative infinity
</li>
</ul>

</blockquote>
</li>
</ol>
</resolution>

</issue>
